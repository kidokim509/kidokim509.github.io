<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)" /><meta name="author" content="Kido Kim" /><meta property="og:locale" content="en_US" /><meta name="description" content="RDD In Memory Immutable Dependency Narrow Wide Properties Partitions blocks, splits Parent dependencies Function (File, Pair, Shuffled, …) Partitioner (Opt.) PreferredLocation (Opt.) Lazy Evaluation (Execution Plan) Transformation Action Memory Management LRU Cache - per partition" /><meta property="og:description" content="RDD In Memory Immutable Dependency Narrow Wide Properties Partitions blocks, splits Parent dependencies Function (File, Pair, Shuffled, …) Partitioner (Opt.) PreferredLocation (Opt.) Lazy Evaluation (Execution Plan) Transformation Action Memory Management LRU Cache - per partition" /><link rel="canonical" href="https://kidokim509.github.io/spark/highperformancespark-chap2/" /><meta property="og:url" content="https://kidokim509.github.io/spark/highperformancespark-chap2/" /><meta property="og:site_name" content="olaf.kido" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-10-17T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Kido Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"datePublished":"2018-10-17T13:00:00+09:00","description":"RDD In Memory Immutable Dependency Narrow Wide Properties Partitions blocks, splits Parent dependencies Function (File, Pair, Shuffled, …) Partitioner (Opt.) PreferredLocation (Opt.) Lazy Evaluation (Execution Plan) Transformation Action Memory Management LRU Cache - per partition","mainEntityOfPage":{"@type":"WebPage","@id":"https://kidokim509.github.io/spark/highperformancespark-chap2/"},"url":"https://kidokim509.github.io/spark/highperformancespark-chap2/","@type":"BlogPosting","author":{"@type":"Person","name":"Kido Kim"},"headline":"스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)","dateModified":"2021-01-19T15:09:55+09:00","@context":"https://schema.org"}</script><title>스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2) | olaf.kido</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RFYKT3284X"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RFYKT3284X'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/olaf.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">olaf.kido</a></div><div class="site-subtitle font-italic">윤윤이 아빠의 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/kidokim509" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://linkedin.com/in/kido-kim-612b78110" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://facebook.com/kidokim509" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 17, 2018, 1:00 PM +0900" > Oct 17, 2018 <i class="unloaded">2018-10-17T13:00:00+09:00</i> </span> by <span class="author"> Kido Kim </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 19, 2021, 3:09 PM +0900" > Jan 19 <i class="unloaded">2021-01-19T15:09:55+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="140 words">1 min</span></div></div><div class="post-content"><h2 id="rdd">RDD</h2><ul><li>In Memory<li>Immutable<ul><li>Dependency<ul><li>Narrow<li>Wide</ul><li>Properties<ul><li>Partitions<ul><li>blocks, splits</ul><li>Parent dependencies<li>Function (File, Pair, Shuffled, …)<li>Partitioner (Opt.)<li>PreferredLocation (Opt.)</ul></ul><li>Lazy Evaluation (Execution Plan)<ul><li>Transformation<li>Action</ul><li>Memory Management<ul><li>LRU Cache - per partition</ul></ul><h2 id="spark-application">Spark Application</h2><ul><li>Jobs (per Action)<ul><li>Stages<ul><li>Set of tasks<li>Stage boundary (Input, Shuffle)<ul><li>Wide dependency</ul><li>Sequencial</ul><li>Tasks<ul><li>Parallel<li>1 Task / Partition<li>N Tasks / Executor (Slots)</ul></ul><li>DAG Scheduler<ul><li>Stage, Task 분할</ul><li>Task Scheduler<ul><li>Cluster Manager를 통해 Task를 알맞은 Worker에 있는 Executor에 할당</ul></ul><h2 id="driver-and-executors">Driver and Executors</h2><ul><li>Driver: Spark Application의 main<li>Executor: 실제 데이터 처리 작업을 수행<ul><li>1 JVM<li>1 core<li>Workers (Nodes)<ul><li>1대의 Worker에서 N개의 executor 실행 (Spark Cluster에서 동시에 여러 Application 실행)</ul></ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dev/'>dev</a>, <a href='/categories/spark/'>spark</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spark/" class="post-tag no-text-decoration" >spark</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2) - olaf.kido&url=https://kidokim509.github.io/spark/highperformancespark-chap2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2) - olaf.kido&u=https://kidokim509.github.io/spark/highperformancespark-chap2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2) - olaf.kido&url=https://kidokim509.github.io/spark/highperformancespark-chap2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/how-to-make-meeting-efficient/">회의를 잘 하기 위한 준비물</a><li><a href="/spark/highperformancespark-chap2/">스파크는 어떻게 동작하는가? (하이 퍼포먼스 스파크 chap2)</a><li><a href="/spark/spark-dataframe-export/">spark dataframe을 csv로 export하기</a><li><a href="/spark/highperformancespark-chap3/">DataFrame, Dataset과 스파크 SQL (하이 퍼포먼스 스파크 chap3)</a><li><a href="/spark/highperformancespark-chap4/">조인(SQL과 코어 스파크) (하이 퍼포먼스 스파크 chap4)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spark/">spark</a> <a class="post-tag" href="/tags/hadoop/">hadoop</a> <a class="post-tag" href="/tags/setting/">setting</a> <a class="post-tag" href="/tags/flume/">flume</a> <a class="post-tag" href="/tags/jupyter/">jupyter</a> <a class="post-tag" href="/tags/agile/">agile</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/acceptance-criteria/">acceptance criteria</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spark-tips/"><div class="card-body"> <span class="timeago small" > Nov 22, 2018 <i class="unloaded">2018-11-22T01:34:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>spark tips</h3><div class="text-muted small"><p> Spark UnitTest 공통 모듈 만들기 만들려는 것 로컬에서 하둡 클러스터 연결 없이 Spark core, Spark sql 모두 테스트 하기 File은 물론, Hive Table로 부터의 DataFrame 로드도 모두 로컬에서 가능하게 하기 Hive Table을 Samplin...</p></div></div></a></div><div class="card"> <a href="/posts/spark-job-unit-test/"><div class="card-body"> <span class="timeago small" > Jan 19, 2019 <i class="unloaded">2019-01-19T12:50:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>principles for the unit test of data processing job</h3><div class="text-muted small"><p> spark job 개발하다가 몇 가지 회고 결과물을 빨리 내겠다고 마음이 급해지니 제일 먼저 UnitTest 개발을 Skip 한다. 여기서부터 코드에서 나쁜 냄새가 나기 시작한다. 가능한한 연산의 과정, 과정을 method로 나누고 UnitTest를 만들자. 특히 numpy나 pandas로...</p></div></div></a></div><div class="card"> <a href="/spark/spark-dataframe-export/"><div class="card-body"> <span class="timeago small" > Oct 19, 2018 <i class="unloaded">2018-10-19T16:50:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>spark dataframe을 csv로 export하기</h3><div class="text-muted small"><p> spark dataframe을 csv로 export하기 jupyter, sparkmagic kernel 기준 1 2 3 %%configure -f {"jars": ["/user/olaf.kido/spark-csv_2.10-1.5.0.jar", "/user/olaf.kido/commons-csv-1.6.jar"]} 1 2 # Spark 1.6이라...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/installing-beakerx/" class="btn btn-outline-primary"><p>installing beakerx</p></a> <a href="/posts/jupyter-notebook-tips/" class="btn btn-outline-primary"><p>jupyter notebook tips</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//olafs-til.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://kidokim509.github.io/spark/highperformancespark-chap2/'; this.page.identifier = '/spark/highperformancespark-chap2/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://www.linkedin.com/in/kido-kim-612b78110">Kido Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/spark/">spark</a> <a class="post-tag" href="/tags/hadoop/">hadoop</a> <a class="post-tag" href="/tags/setting/">setting</a> <a class="post-tag" href="/tags/flume/">flume</a> <a class="post-tag" href="/tags/jupyter/">jupyter</a> <a class="post-tag" href="/tags/agile/">agile</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/acceptance-criteria/">acceptance criteria</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://kidokim509.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
